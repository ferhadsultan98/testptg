<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ≈û…ôkil Yaradƒ±cƒ± | PRO</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #6366f1;
            --primary-hover: #4f46e5;
            --primary-glow: rgba(99,102,241,0.35);
            --bg: #0a0e1a;
            --surface: #111827;
            --surface2: #1a2235;
            --border: #1e2d45;
            --text: #f1f5f9;
            --muted: #64748b;
            --success: #10b981;
            --success-hover: #059669;
            --danger: #ef4444;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 24px 16px 48px;
            background-image:
                radial-gradient(ellipse 80% 50% at 50% -20%, rgba(99,102,241,0.12), transparent),
                radial-gradient(ellipse 60% 40% at 80% 80%, rgba(168,85,247,0.07), transparent);
        }

        /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
        .page-header {
            text-align: center;
            margin-bottom: 32px;
            padding-top: 16px;
        }
        .page-header .badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(99,102,241,0.15);
            border: 1px solid rgba(99,102,241,0.3);
            color: #a5b4fc;
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 1.2px;
            text-transform: uppercase;
            padding: 4px 12px;
            border-radius: 20px;
            margin-bottom: 14px;
        }
        .page-header h1 {
            font-size: clamp(26px, 5vw, 40px);
            font-weight: 800;
            background: linear-gradient(135deg, #c4b5fd 0%, #818cf8 40%, #6366f1 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1.2;
            margin-bottom: 10px;
        }
        .page-header p {
            color: var(--muted);
            font-size: 14px;
            max-width: 500px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* ‚îÄ‚îÄ MAIN CARD ‚îÄ‚îÄ */
        .card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 28px;
            width: 100%;
            max-width: 860px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }

        /* ‚îÄ‚îÄ SECTION LABEL ‚îÄ‚îÄ */
        .section-label {
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 1px;
            text-transform: uppercase;
            color: var(--muted);
            margin-bottom: 8px;
        }

        /* ‚îÄ‚îÄ PROMPT AREA ‚îÄ‚îÄ */
        .prompt-wrapper {
            position: relative;
            margin-bottom: 16px;
        }
        textarea#promptInput {
            width: 100%;
            height: 110px;
            background: var(--bg);
            border: 1.5px solid var(--border);
            color: var(--text);
            padding: 14px 16px;
            padding-bottom: 40px;
            border-radius: 14px;
            resize: none;
            font-size: 15px;
            line-height: 1.6;
            transition: border-color 0.2s, box-shadow 0.2s;
            font-family: inherit;
        }
        textarea#promptInput::placeholder { color: var(--muted); }
        textarea#promptInput:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--primary-glow);
        }
        .char-count {
            position: absolute;
            bottom: 12px;
            right: 14px;
            font-size: 11px;
            color: var(--muted);
            pointer-events: none;
        }
        .char-count.warn { color: #f59e0b; }

        /* ‚îÄ‚îÄ CONTROLS GRID ‚îÄ‚îÄ */
        .controls-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 12px;
            margin-bottom: 16px;
        }
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        select {
            width: 100%;
            background: var(--bg);
            border: 1.5px solid var(--border);
            color: var(--text);
            padding: 10px 14px;
            border-radius: 12px;
            font-size: 13px;
            cursor: pointer;
            outline: none;
            transition: border-color 0.2s;
            -webkit-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%2364748b' stroke-width='1.5' d='M6 8l4 4 4-4'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 18px;
            padding-right: 32px;
        }
        select:focus { border-color: var(--primary); }
        select option { background: #1a2235; }

        /* ‚îÄ‚îÄ ENHANCE TOGGLE ‚îÄ‚îÄ */
        .enhance-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 18px;
            padding: 10px 14px;
            background: var(--surface2);
            border: 1px solid var(--border);
            border-radius: 12px;
        }
        .toggle {
            position: relative;
            width: 38px;
            height: 22px;
            flex-shrink: 0;
        }
        .toggle input { opacity: 0; width: 0; height: 0; }
        .toggle-slider {
            position: absolute;
            inset: 0;
            background: var(--border);
            border-radius: 22px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .toggle-slider::before {
            content: '';
            position: absolute;
            width: 16px;
            height: 16px;
            left: 3px;
            top: 3px;
            background: white;
            border-radius: 50%;
            transition: transform 0.2s;
        }
        .toggle input:checked + .toggle-slider { background: var(--primary); }
        .toggle input:checked + .toggle-slider::before { transform: translateX(16px); }
        .enhance-text {
            font-size: 13px;
            color: var(--text);
            flex: 1;
        }
        .enhance-text span {
            display: block;
            font-size: 11px;
            color: var(--muted);
            margin-top: 1px;
        }
        .enhance-badge {
            font-size: 10px;
            font-weight: 700;
            background: rgba(99,102,241,0.2);
            color: #a5b4fc;
            padding: 2px 8px;
            border-radius: 6px;
        }

        /* ‚îÄ‚îÄ GENERATE BUTTON ‚îÄ‚îÄ */
        #generateBtn {
            width: 100%;
            background: linear-gradient(135deg, #6366f1, #7c3aed);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 14px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.2s;
            letter-spacing: 0.3px;
            box-shadow: 0 4px 20px rgba(99,102,241,0.3);
            margin-bottom: 24px;
        }
        #generateBtn:hover:not(:disabled) {
            background: linear-gradient(135deg, #4f46e5, #6d28d9);
            box-shadow: 0 6px 28px rgba(99,102,241,0.45);
            transform: translateY(-1px);
        }
        #generateBtn:active:not(:disabled) { transform: translateY(0); }
        #generateBtn:disabled {
            background: #1e2d45;
            color: var(--muted);
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }

        /* ‚îÄ‚îÄ RESULT AREA ‚îÄ‚îÄ */
        .result-section { width: 100%; }
        .result-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        #resultArea {
            position: relative;
            width: 100%;
            min-height: 340px;
            background: var(--bg);
            border: 2px dashed var(--border);
            border-radius: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            transition: border-color 0.3s;
        }
        #resultArea.has-image {
            border: 2px solid var(--border);
            min-height: unset;
        }

        #resultImage {
            width: 100%;
            display: none;
            border-radius: 14px;
            object-fit: contain;
        }

        /* ‚îÄ‚îÄ EMPTY STATE ‚îÄ‚îÄ */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            color: var(--muted);
            padding: 40px 20px;
        }
        .empty-state i { opacity: 0.3; }
        .empty-state p { font-size: 14px; }

        /* ‚îÄ‚îÄ LOADER ‚îÄ‚îÄ */
        #loader {
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 18px;
            padding: 50px 20px;
        }
        .spinner-ring {
            width: 54px;
            height: 54px;
            border: 4px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        .loader-text {
            color: var(--muted);
            font-size: 14px;
        }
        .loader-dots::after {
            content: '';
            animation: dots 1.5s steps(4, end) infinite;
        }
        @keyframes dots {
            0%   { content: ''; }
            25%  { content: '.'; }
            50%  { content: '..'; }
            75%  { content: '...'; }
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* ‚îÄ‚îÄ PROGRESS BAR ‚îÄ‚îÄ */
        .progress-wrap {
            width: 180px;
            height: 4px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #6366f1, #a855f7);
            border-radius: 4px;
            animation: progress 18s ease-out forwards;
        }
        @keyframes progress {
            0%   { width: 0%; }
            60%  { width: 70%; }
            90%  { width: 88%; }
            100% { width: 92%; }
        }

        /* ‚îÄ‚îÄ ERROR STATE ‚îÄ‚îÄ */
        .error-state {
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            padding: 40px 20px;
            color: var(--danger);
            text-align: center;
        }
        .error-state i { font-size: 32px; opacity: 0.7; }
        .error-state p { font-size: 14px; color: var(--muted); }
        .retry-btn {
            background: rgba(239,68,68,0.1);
            border: 1px solid rgba(239,68,68,0.3);
            color: var(--danger);
            padding: 8px 20px;
            border-radius: 10px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        .retry-btn:hover { background: rgba(239,68,68,0.2); }

        /* ‚îÄ‚îÄ IMAGE META ‚îÄ‚îÄ */
        .image-meta {
            display: none;
            align-items: center;
            justify-content: space-between;
            margin-top: 12px;
            gap: 10px;
            flex-wrap: wrap;
        }
        .meta-chip {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            background: var(--surface2);
            border: 1px solid var(--border);
            padding: 4px 10px;
            border-radius: 8px;
            font-size: 11px;
            color: var(--muted);
        }
        .meta-chip i { font-size: 10px; }

        /* ‚îÄ‚îÄ DOWNLOAD BUTTON ‚îÄ‚îÄ */
        #downloadBtn {
            display: none;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            padding: 13px 20px;
            border-radius: 14px;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-top: 12px;
            width: 100%;
            transition: all 0.2s;
            box-shadow: 0 4px 16px rgba(16,185,129,0.25);
        }
        #downloadBtn:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 22px rgba(16,185,129,0.35);
        }

        /* ‚îÄ‚îÄ MODEL INFO TOOLTIP ‚îÄ‚îÄ */
        .model-tip {
            font-size: 11px;
            color: var(--muted);
            margin-top: 4px;
            min-height: 16px;
            transition: opacity 0.2s;
        }

        /* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
        .footer {
            margin-top: 24px;
            text-align: center;
            color: var(--muted);
            font-size: 12px;
        }

        /* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
        @media (max-width: 640px) {
            .card { padding: 20px; }
            .controls-grid { grid-template-columns: 1fr 1fr; }
            .controls-grid .control-group:last-child { grid-column: 1/-1; }
            #resultArea { min-height: 260px; }
        }
        @media (max-width: 420px) {
            .controls-grid { grid-template-columns: 1fr; }
            .controls-grid .control-group:last-child { grid-column: auto; }
        }
    </style>
</head>
<body>

    <header class="page-header">
        <div class="badge"><i class="fa-solid fa-sparkles"></i> Powered by Pollinations AI</div>
        <h1><i class="fa-solid fa-wand-magic-sparkles"></i> AI ≈û…ôkil Yaradƒ±cƒ±</h1>
        <p>X…ôyal etdiyinizi yazƒ±n ‚Äî s√ºni intellekt anƒ±nda ≈ü…ôkil yaratsƒ±n. He√ß bir qeydiyyat t…ôl…ôb olunmur.</p>
    </header>

    <div class="card">

        <!-- PROMPT -->
        <div class="section-label">≈û…ôkil T…ôsviri</div>
        <div class="prompt-wrapper">
            <textarea id="promptInput"
                placeholder="M…ôs…ôl…ôn: G…ôl…ôc…ôyin Bakƒ± ≈ü…ôh…ôri, u√ßan ma≈üƒ±nlar, kiberpank stili, neon i≈üƒ±qlar, ≈ü…ôh…ôr m…ônz…ôr…ôsi, g√∂y √ºz√º, yaƒüƒ±≈ü, 8k ultra detailed..."></textarea>
            <span class="char-count" id="charCount">0 / 500</span>
        </div>

        <!-- CONTROLS -->
        <div class="controls-grid">
            <div class="control-group">
                <div class="section-label">Model</div>
                <select id="modelSelect">
                    <option value="flux">‚ú¶ Flux ‚Äî ∆èn Yax≈üƒ±</option>
                    <option value="flux-realism">‚ú¶ Flux Realism</option>
                    <option value="flux-anime">‚ú¶ Flux Anime</option>
                    <option value="flux-3d">‚ú¶ Flux 3D</option>
                    <option value="turbo">‚ö° Turbo ‚Äî S√ºr…ôtli</option>
                    <option value="gptimage">‚óà GPT Image</option>
                    <option value="seedream">‚óà Seedream</option>
                </select>
                <div class="model-tip" id="modelTip">∆èn y√ºks…ôk keyfiyy…ôt</div>
            </div>

            <div class="control-group">
                <div class="section-label">Nisb…ôt</div>
                <select id="ratioSelect">
                    <option value="square_1024">‚¨ú Kvadrat  1:1</option>
                    <option value="portrait_768_1344">üì± Telefon  9:16</option>
                    <option value="landscape_1344_768">üñ•  Geni≈ü  16:9</option>
                    <option value="portrait_832_1216">üì∑ Portret  2:3</option>
                    <option value="landscape_1216_832">üñº  Landscape  3:2</option>
                    <option value="square_768">üì¶ Ki√ßik  768px</option>
                </select>
            </div>

            <div class="control-group">
                <div class="section-label">Seed</div>
                <select id="seedSelect">
                    <option value="random">üé≤ T…ôsad√ºfi</option>
                    <option value="42">42</option>
                    <option value="123">123</option>
                    <option value="777">777</option>
                    <option value="1337">1337</option>
                    <option value="9999">9999</option>
                </select>
            </div>
        </div>

        <!-- ENHANCE TOGGLE -->
        <div class="enhance-row">
            <label class="toggle">
                <input type="checkbox" id="enhanceToggle" checked>
                <span class="toggle-slider"></span>
            </label>
            <div class="enhance-text">
                Prompt G√ºcl…ôndir
                <span>AI avtomatik olaraq promptu daha detallƒ± hala g…ôtirir</span>
            </div>
            <span class="enhance-badge">AI BOOST</span>
        </div>

        <!-- GENERATE BUTTON -->
        <button id="generateBtn">
            <i class="fa-solid fa-image"></i>
            <span id="btnText">≈û…ôkil Yarat</span>
        </button>

        <!-- RESULT -->
        <div class="result-section">
            <div class="result-header">
                <div class="section-label" style="margin:0">N…ôtic…ô</div>
                <div id="currentSeedLabel" style="font-size:11px;color:var(--muted);display:none">
                    Seed: <span id="seedDisplay">‚Äî</span>
                </div>
            </div>

            <div id="resultArea">
                <div class="empty-state" id="emptyState">
                    <i class="fa-regular fa-image fa-3x"></i>
                    <p>N…ôtic…ô burada g√∂r√ºn…ôc…ôk</p>
                </div>

                <div id="loader">
                    <div class="spinner-ring"></div>
                    <div class="progress-wrap"><div class="progress-bar" id="progressBar"></div></div>
                    <p class="loader-text">≈û…ôkil yaradƒ±lƒ±r<span class="loader-dots"></span></p>
                </div>

                <div class="error-state" id="errorState">
                    <i class="fa-solid fa-triangle-exclamation"></i>
                    <strong>X…ôta ba≈ü verdi</strong>
                    <p id="errorMsg">Baƒülantƒ± problemi. Yenid…ôn yoxlayƒ±n.</p>
                    <button class="retry-btn" id="retryBtn"><i class="fa-solid fa-rotate-right"></i> Yenid…ôn C…ôhd Et</button>
                </div>

                <img id="resultImage" alt="AI t…ôr…ôfind…ôn yaradƒ±lmƒ±≈ü ≈ü…ôkil">
            </div>

            <div class="image-meta" id="imageMeta">
                <div>
                    <span class="meta-chip"><i class="fa-solid fa-microchip"></i> <span id="metaModel">‚Äî</span></span>
                    <span class="meta-chip"><i class="fa-solid fa-expand"></i> <span id="metaSize">‚Äî</span></span>
                    <span class="meta-chip"><i class="fa-solid fa-hashtag"></i> <span id="metaSeed">‚Äî</span></span>
                </div>
            </div>

            <button id="downloadBtn">
                <i class="fa-solid fa-download"></i> ≈û…ôkli Y√ºkl…ô (Orijinal Keyfiyy…ôt)
            </button>
        </div>

    </div>

    <div class="footer">Pollinations.AI ¬∑ Pulsuz ¬∑ Qeydiyyatsƒ±z ¬∑ A√ßƒ±q M…ônb…ôli</div>

<script>
    // ‚îÄ‚îÄ DOM ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const promptInput   = document.getElementById('promptInput');
    const charCount     = document.getElementById('charCount');
    const modelSelect   = document.getElementById('modelSelect');
    const ratioSelect   = document.getElementById('ratioSelect');
    const seedSelect    = document.getElementById('seedSelect');
    const enhanceToggle = document.getElementById('enhanceToggle');
    const generateBtn   = document.getElementById('generateBtn');
    const btnText       = document.getElementById('btnText');
    const resultArea    = document.getElementById('resultArea');
    const resultImage   = document.getElementById('resultImage');
    const emptyState    = document.getElementById('emptyState');
    const loader        = document.getElementById('loader');
    const progressBar   = document.getElementById('progressBar');
    const errorState    = document.getElementById('errorState');
    const errorMsg      = document.getElementById('errorMsg');
    const retryBtn      = document.getElementById('retryBtn');
    const downloadBtn   = document.getElementById('downloadBtn');
    const imageMeta     = document.getElementById('imageMeta');
    const metaModel     = document.getElementById('metaModel');
    const metaSize      = document.getElementById('metaSize');
    const metaSeed      = document.getElementById('metaSeed');
    const seedDisplay   = document.getElementById('seedDisplay');
    const seedLabel     = document.getElementById('currentSeedLabel');
    const modelTip      = document.getElementById('modelTip');

    // ‚îÄ‚îÄ Model t…ôsviri ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const MODEL_TIPS = {
        'flux':          '∆èn y√ºks…ôk keyfiyy…ôt, realist',
        'flux-realism':  'Foto-realizm √º√ß√ºn …ôn yax≈üƒ±',
        'flux-anime':    'Anime / manga stili',
        'flux-3d':       '3D render stili',
        'turbo':         'S√ºr…ôtli, orta keyfiyy…ôt',
        'gptimage':      'GPT d…ôqiqliyi + keyfiyy…ôt',
        'seedream':      'Yaradƒ±cƒ±, b…ôdii stil',
    };
    modelSelect.addEventListener('change', () => {
        modelTip.textContent = MODEL_TIPS[modelSelect.value] || '';
    });

    // ‚îÄ‚îÄ Ratio ‚Üí width/height ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const RATIOS = {
        'square_1024':        [1024, 1024],
        'portrait_768_1344':  [768,  1344],
        'landscape_1344_768': [1344, 768],
        'portrait_832_1216':  [832,  1216],
        'landscape_1216_832': [1216, 832],
        'square_768':         [768,  768],
    };

    // ‚îÄ‚îÄ Char counter ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    promptInput.addEventListener('input', () => {
        const len = promptInput.value.length;
        charCount.textContent = `${len} / 500`;
        charCount.classList.toggle('warn', len > 420);
    });

    // ‚îÄ‚îÄ M√∂vcud URL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    let currentBlobUrl = '';
    let lastParams = null;

    // ‚îÄ‚îÄ Yenid…ôn c…ôhd ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    retryBtn.addEventListener('click', () => {
        if (lastParams) generateImage(lastParams);
    });

    // ‚îÄ‚îÄ Yarat d√ºym…ôsi ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    generateBtn.addEventListener('click', () => {
        const prompt = promptInput.value.trim();
        if (!prompt) {
            promptInput.focus();
            promptInput.style.borderColor = '#ef4444';
            setTimeout(() => { promptInput.style.borderColor = ''; }, 1500);
            return;
        }

        const [width, height] = RATIOS[ratioSelect.value] || [1024, 1024];
        const model   = modelSelect.value;
        const enhance = enhanceToggle.checked;
        const seed    = seedSelect.value === 'random'
            ? Math.floor(Math.random() * 999999) + 1
            : parseInt(seedSelect.value);

        lastParams = { prompt, width, height, model, enhance, seed };
        generateImage(lastParams);
    });

    // ‚îÄ‚îÄ ∆èsas funksiya ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function generateImage({ prompt, width, height, model, enhance, seed }) {

        // UI ‚Üí y√ºkl…ôm…ô rejimi
        setLoading(true);

        // Seed g√∂st…ôr
        seedDisplay.textContent  = seed;
        seedLabel.style.display  = 'block';
        metaSeed.textContent     = seed;
        metaModel.textContent    = model;
        metaSize.textContent     = `${width}√ó${height}`;

        // URL qur
        const encodedPrompt = encodeURIComponent(prompt);
        const params = new URLSearchParams({
            width:   width,
            height:  height,
            seed:    seed,
            model:   model,
            nologo:  'true',
            enhance: enhance ? 'true' : 'false',
            private: 'false',
        });
        const apiUrl = `https://image.pollinations.ai/prompt/${encodedPrompt}?${params.toString()}`;

        // ≈û…ôkli y√ºkl…ô
        const img = new Image();
        img.crossOrigin = 'anonymous';

        img.onload = function() {
            // Blob alƒ±rƒ±q ki, y√ºkl…ôn…ô bilsin
            fetch(apiUrl)
                .then(r => {
                    if (!r.ok) throw new Error(`HTTP ${r.status}`);
                    return r.blob();
                })
                .then(blob => {
                    if (currentBlobUrl) URL.revokeObjectURL(currentBlobUrl);
                    currentBlobUrl = URL.createObjectURL(blob);

                    resultImage.src = currentBlobUrl;
                    showResult();
                })
                .catch(() => {
                    // fetch uƒüursuz olsa bel…ô img.src artƒ±q y√ºkl…ônib ‚Äî onu g√∂st…ôr
                    resultImage.src = apiUrl;
                    showResultDirect();
                });
        };

        img.onerror = function() {
            showError('≈û…ôkil yaradƒ±la bilm…ôdi. Ba≈üqa model v…ô ya prompt sƒ±nayƒ±n.');
        };

        // Vaxt a≈üƒ±mƒ± ‚Äî 90 saniy…ô
        const timeout = setTimeout(() => {
            img.onload = null;
            img.onerror = null;
            showError('Zaman a≈üƒ±mƒ± (90s). Server m…ô≈üƒüuldur, yenid…ôn c…ôhd edin.');
        }, 90000);

        img.onload = function() {
            clearTimeout(timeout);
            // Y√ºkl…ônmi≈ü ≈ü…ôkli blob kimi g√∂t√ºr
            fetch(apiUrl)
                .then(r => r.ok ? r.blob() : Promise.reject(r.status))
                .then(blob => {
                    if (currentBlobUrl) URL.revokeObjectURL(currentBlobUrl);
                    currentBlobUrl = URL.createObjectURL(blob);
                    resultImage.src = currentBlobUrl;
                    showResult();
                })
                .catch(() => {
                    // CORS problemi olsa birba≈üa URL istifad…ô et
                    resultImage.src = apiUrl;
                    currentBlobUrl = apiUrl;
                    showResult();
                });
        };

        img.onerror = function() {
            clearTimeout(timeout);
            showError('≈û…ôkil yaradƒ±la bilm…ôdi. Ba≈üqa model v…ô ya prompt sƒ±nayƒ±n.');
        };

        img.src = apiUrl;
    }

    // ‚îÄ‚îÄ Y√ºkl…ôm…ô v…ôziyy…ôti ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function setLoading(state) {
        generateBtn.disabled = state;
        btnText.textContent  = state ? 'Yaradƒ±lƒ±r...' : '≈û…ôkil Yarat';
        generateBtn.querySelector('i').className = state
            ? 'fa-solid fa-spinner fa-spin'
            : 'fa-solid fa-image';

        emptyState.style.display  = 'none';
        errorState.style.display  = 'none';
        imageMeta.style.display   = 'none';
        downloadBtn.style.display = 'none';
        resultImage.style.display = 'none';
        resultArea.classList.remove('has-image');

        if (state) {
            loader.style.display = 'flex';
            // Progress bar yenid…ôn ba≈ülat
            progressBar.style.animation = 'none';
            progressBar.offsetHeight; // reflow
            progressBar.style.animation = '';
            resultArea.style.border = '2px solid var(--border)';
        } else {
            loader.style.display = 'none';
        }
    }

    // ‚îÄ‚îÄ N…ôtic…ôni g√∂st…ôr ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function showResult() {
        loader.style.display      = 'none';
        generateBtn.disabled      = false;
        btnText.textContent       = 'Yenid…ôn Yarat';
        generateBtn.querySelector('i').className = 'fa-solid fa-rotate-right';

        resultImage.style.display = 'block';
        resultArea.classList.add('has-image');
        resultArea.style.border   = '2px solid var(--border)';

        imageMeta.style.display   = 'flex';
        downloadBtn.style.display = 'flex';
    }

    function showResultDirect() { showResult(); }

    // ‚îÄ‚îÄ X…ôta g√∂st…ôr ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function showError(msg) {
        loader.style.display     = 'none';
        generateBtn.disabled     = false;
        btnText.textContent      = '≈û…ôkil Yarat';
        generateBtn.querySelector('i').className = 'fa-solid fa-image';

        errorMsg.textContent          = msg;
        errorState.style.display      = 'flex';
        resultArea.style.border       = '2px dashed #ef444444';
    }

    // ‚îÄ‚îÄ Y√ºkl…ô ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    downloadBtn.addEventListener('click', () => {
        if (!currentBlobUrl) return;

        const model  = modelSelect.value;
        const ts     = new Date().toISOString().slice(0,19).replace(/[:T]/g, '-');
        const fname  = `AI_Sekil_${model}_${ts}.jpg`;

        if (currentBlobUrl.startsWith('blob:')) {
            const a = document.createElement('a');
            a.href     = currentBlobUrl;
            a.download = fname;
            a.click();
        } else {
            // CORS yoxdursa, yeni sekmede a√ß
            window.open(currentBlobUrl, '_blank');
        }
    });
</script>
</body>
</html>